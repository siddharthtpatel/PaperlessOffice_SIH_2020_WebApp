{% extends 'layout.html' %}
{% load static %}
{% block content %}
<!-- MDBootstrap Datatables  -->
<link href="{% static 'css/addons/datatables.min.css' %}" rel="stylesheet">
<style>
  table.dataTable thead .sorting:after,
    table.dataTable thead .sorting:before,
    table.dataTable thead .sorting_asc:after,
    table.dataTable thead .sorting_asc:before,
    table.dataTable thead .sorting_asc_disabled:after,
    table.dataTable thead .sorting_asc_disabled:before,
    table.dataTable thead .sorting_desc:after,
    table.dataTable thead .sorting_desc:before,
    table.dataTable thead .sorting_desc_disabled:after,
    table.dataTable thead .sorting_desc_disabled:before {
      bottom: .5em;
    }
  .popup {
	position: absolute;
	width: 100%;
	height: 100vh;
	display: none;
	justify-content: center;
	align-items: center;
	overflow: hidden;
	/* background-color: aqua; */
}

.main-popup {
	position: absolute;
	left: 0;
  bottom: 180px;
	height: auto;
	width: 500px;
	background: #8fd19e;
	padding: 30px 20px;
	line-height: 1rem;
	display: flex;
	justify-content: center;
	align-items: center;
	transform: translateX(-100%);
}
.close-btn {
	padding: 10px;
	position: absolute;
	top: 1rem;
	right: 1rem;
	font-size: 2rem;
	cursor: pointer;
	transition: .5s ease all;
}
.popup-content p {
	font-size: 1.5rem;
	line-height: 2rem;
}
@keyframes slide-in {
	0% {
		transform: translateX(200%);
	}
	100% {
		transform: translateX(122%);
	}
}
@keyframes slide-out {
	0% {
		transform: translateX(122%);
	}
	100% {
		transform: translateX(250%);
	}
}  
</style>
  <!-- Main layout -->
  <main>
    
    <div class="container">
      <div class="popup">
        <div class="popup-overlay"></div>
        <div class="main-popup">
          <div class="popup-content">
            <span class="close-btn">&times;</span>
            <p>Kudos !</p>
            <p>You save <b>Rs {{cost_per_paper}} </b> everytime you submit an e-application.<br>
              You have saved <b>Rs {{ money_saved }} </b> in total.<br>
              You saved <b>{{ trees_saved }}</b> trees<br></p>
          </div>
        </div>
      </div>
        <style>
        .nav-pills .nav-link.active, .nav-pills .show>.nav-link {
            background-color: green;

          } 
        </style>
      <div class="black-text">
            <ul class="nav md-tabs nav-justified green mb-0" id="myTab" role="tablist">
                <li class="nav-item">
                  <a href="#AllApplication" class="nav-link active" data-toggle="tab"><h5 class="font-weight-500 my-1" >All Applications</h5></a>
              </li>
                  <li class="nav-item">
                      <a href="#PendingApplication" class="nav-link" data-toggle="tab"><h5 class="font-weight-500 my-1"  >Pending Applications</h5></a>
                  </li>
                  <li class="nav-item">
                      <a href="#ApprovedApplication" class="nav-link" data-toggle="tab"><h5 class="font-weight-500 my-1"  >Approved Applications</h5></a>
                  </li>
                  <li class="nav-item">
                    <a href="#RejectedApplication" class="nav-link" data-toggle="tab"><h5 class="font-weight-500 my-1"  >Rejected Applications</h5></a>
                </li>
            </ul>
        </div>
      <div class="tab-content">
          <div class="tab-pane fade show active" id="AllApplication">
            <!-- Section: Applications -->
              <section class="pb-12">
                {% if all_applications|length < 1 %}
                <div class="mt-3 container text-center">
                    <h4>You don't have any Applications!</h4>
                    <p>Please apply for Application.</p>
                </div>
                {% else %}

                   <div class="">
                    <table id="allApplicationsDT" class="table table-striped table-bordered table-sm" cellspacing="0">
                        <thead>
                          <tr class="table-success">
                            <th scope="col">Name</th>
                            <th scope="col">Submitted By</th>
                            <th scope="col">Current Stage</th>
                            <th scope="col">Date</th>
                            <th scope="col">Actions</th>
                          </tr>
                        </thead>
                          <tbody>
                          {% for application in all_applications %}
                          <tr>
                          <td>{{ application.name }}</td>
                          <td>{{ application.creatorName }}</td>
                          <td>{{ application.stage }}/{{ application.stages }}</td>
                          <td>{{ application.timestamp }}</td>
                          <td><span onclick="on_view_click(this)"> <i class="fas fa-eye" style="cursor:pointer" aria-hidden="true"></i></span>
                              <span class="ml-2" onclick="on_info_click(this)"><i class="fas fa-info-circle"></i></span>
                          </td>
                          </tr>
                          {% endfor %}
                        </tbody>
                      </table>
                   </div>
                {% endif %}
              </section>
            <!-- Section: data tables -->
          </div>
          <div class="tab-pane fade" id="PendingApplication">
              <!-- Section: Applications -->
              <section class="pb-12">
               {% if pending_applications|length < 1 %}
                <div class="mt-3 container text-center">
                    <h4>You don't have any Pending Application!</h4>
                    <p>Please apply for application.</p>
                </div>
                {% else %}

                   <div class="">
                    <table id="pendingApplicationsDT" class="table table-striped table-bordered table-sm" cellspacing="0">
                        <thead>
                          <tr class="table-success">
                            <th scope="col">Name</th>
                            <th scope="col">Submitted By</th>
                            <th scope="col">Current Stage</th>
                            <th scope="col">Date</th>
                              <th scope="col">Actions</th>
                          </tr>
                        </thead>
                          <tbody>
                          {% for application in pending_applications %}
                            <tr>
                          <td>{{ application.name }}</td>
                          <td>{{ application.creatorName }}</td>
                          <td>{{ application.stage }}/{{ application.stages }}</td>
                          <td>{{ application.timestamp }}</td>
                          <td><span onclick="on_view_click(this)"> <i class="fas fa-eye" style="cursor:pointer" aria-hidden="true"></i></span>
                              <span class="ml-2" onclick="on_info_click(this)"><i class="fas fa-info-circle"></i></span>
                          </td>
                            </tr>
                          {% endfor %}
                        </tbody>
                      </table>
                   </div>
                {% endif %}
              </section>  
            <!-- Section: data tables -->
          </div>
          <div class="tab-pane fade" id="ApprovedApplication">
             <!-- Section: Applications -->
              <section class="pb-12">
                {% if approved_applications|length < 1 %}
                <div class="mt-3 container text-center">
                    <h4>You don't have any Approved Application!</h4>
                    <p>Please apply for application.</p>
                </div>
                {% else %}

                   <div class="">
                    <table id="approvedApplicationsDT" class="table table-striped table-bordered table-sm" cellspacing="0">
                        <thead>
                          <tr class="table-success">
                            <th scope="col">Name</th>
                            <th scope="col">Submitted By</th>
                            <th scope="col">Current Stage</th>
                            <th scope="col">Date</th>
                              <th scope="col">Actions</th>
                          </tr>
                        </thead>
                          <tbody>
                          {% for application in approved_applications %}
                            <tr>
                          <td>{{ application.name }}</td>
                          <td>{{ application.creatorName }}</td>
                          <td>{{ application.stage }}/{{ application.stages }}</td>
                          <td>{{ application.timestamp }}</td>
                          <td><span onclick="on_view_click(this)"> <i class="fas fa-eye" style="cursor:pointer" aria-hidden="true"></i></span>
                              <span class="ml-2" onclick="on_info_click(this)"><i class="fas fa-info-circle"></i></span>
                          </td>
                            </tr>
                          {% endfor %}
                        </tbody>
                      </table>
                   </div>
                {% endif %}
              </section>  
              <!-- Section: data tables -->
          </div>
          <div class="tab-pane fade" id="RejectedApplication">
            <!-- Section: Applications -->
             <section class="pb-12">
               {% if rejected_applications|length < 1 %}
                <div class="mt-3 container text-center">
                    <h4>You don't have any Application!</h4>
                    <p>Please apply for application.</p>
                </div>
                {% else %}

                   <div class="">
                    <table id="rejectedApplicationsDT" class="table table-striped table-bordered table-sm" cellspacing="0">
                        <thead>
                          <tr class="table-success">
                            <th scope="col">Name</th>
                            <th scope="col">Submitted By</th>
                            <th scope="col">Current Stage</th>
                            <th scope="col">Date</th>
                            <th scope="col">Actions</th>
                          </tr>
                        </thead>
                          <tbody>
                          {% for application in rejected_applications %}
                            <tr>
                          <td>{{ application.name }}</td>
                          <td>{{ application.creatorName }}</td>
                          <td>{{ application.stage }}/{{ application.stages }}</td>
                          <td>{{ application.timestamp }}</td>
                          <td><span onclick="on_view_click(this)"> <i class="fas fa-eye" style="cursor:pointer" aria-hidden="true"></i></span>
                              <span class="ml-2" onclick="on_info_click(this)"><i class="fas fa-info-circle"></i></span>
                          </td>
                            </tr>
                          {% endfor %}
                        </tbody>
                      </table>
                   </div>
                {% endif %}
             </section>  
             <!-- Section: data tables -->
         </div>
      </div>
    </div>
  </main>
  <!-- Main layout -->
{% endblock %}
{% block scripts %}
<!-- MDBootstrap Datatables  -->
<script type="text/javascript" src="{% static 'js/addons/datatables.min.js' %}"></script>
<script>
  $(document).ready(function () {
    $('#allApplicationsDT').DataTable();
    $('#pendingApplicationsDT').DataTable();
    $('#approvedApplicationsDT').DataTable();
    $('#rejectedApplicationsDT').DataTable();
    $('.dataTables_length').addClass('bs-select');
  });

const open_btn = document.querySelector('.open-btn');
const close_btn = document.querySelector('.close-btn');
const popup = document.querySelector('.popup');
const main_popup = document.querySelector('.main-popup');

window.addEventListener('load', () => {
	popup.style.display = 'flex';
	main_popup.style.cssText = 'animation:slide-in .5s ease; animation-fill-mode: forwards;';
}, false);

close_btn.addEventListener('click', () => {
	main_popup.style.cssText = 'animation:slide-out .5s ease; animation-fill-mode: forwards;';
	setTimeout(() => {
		popup.style.display = 'none';
	}, 500);
});

window.addEventListener('click', (e) => {
	if (e.target == document.querySelector('.popup-overlay')) {
		main_popup.style.cssText = 'animation:slide-out .5s ease; animation-fill-mode: forwards;';
		setTimeout(() => {
			popup.style.display = 'none';
		}, 500);
	}
});

</script>
{% endblock %}